# HW10 — CVE exploit PoC

Разработка Proof of Concept (PoC) для эксплуатации уязвимости.
Работа выполнена в рамках домашнего задания по курсу Python.

Скрипт предназначен **для учебных и лабораторных целей** и имитирует проверку уязвимости без выполнения полноценной эксплуатации.

## Описание уязвимости

**CVE-2021-41773** — уязвимость обхода пути (Path Traversal) в **Apache HTTP Server версии 2.4.49**.

Уязвимость возникает вследствие некорректной нормализации URL-путей при обработке URL-кодированных последовательностей (`.%2e`).  
В результате атакующий может получить доступ к файлам за пределами корневой директории веб-сервера и читать произвольные файлы на системе при определённых конфигурациях сервера.

Уязвимость устранена в версиях **Apache HTTP Server 2.4.51 и выше**.

---

## Описание PoC-скрипта

Данный скрипт представляет собой **минимальный Proof of Concept**, демонстрирующий:

- формирование HTTP-запроса с использованием traversal-паттерна, характерного для CVE-2021-41773;
- отправку запроса к указанному домену;
- анализ HTTP-ответа и вывод сообщения о потенциальной уязвимости.

Скрипт предназначен **для учебных и лабораторных целей** и имитирует проверку уязвимости без выполнения полноценной эксплуатации.


---

## Инструкция по использованию

1. Убедитесь, что в системе установлен Python версии **3.8 или выше** и библиотека `requests`.

2. Установите зависимость (при необходимости): 
```bash
pip install requests
```

3. Запустите скрипт, передав домен или URL для проверки:
```bash
python poc.py example.com
```

---


## Пример вывода скрипта

### Успешный запуск (уязвимость проявляется)

В случае, если целевой сервер уязвим и запрос с traversal-паттерном обрабатывается некорректно, скрипт выводит сообщение о потенциальной уязвимости и часть ответа сервера:

```text
[+] Потенциальная уязвимость обнаружена. Ответ сервера:
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
```

### Неуспешный запуск (уязвимость не подтверждена)

Если целевой сервер не уязвим, используется исправленная версия Apache или доступ к файловой системе ограничен конфигурацией, скрипт выводит сообщение об отсутствии подтверждения уязвимости и HTTP-код ответа:

```text
[-] Уязвимость не подтверждена. Код ответа: 403
<html><body><h1>403 Forbidden</h1></body></html>
```