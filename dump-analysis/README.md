# Анализ сетевого трафика — Форензика

Домашнее задание по дисциплине «Программирование на Python».  
Тема: Python для аналитиков ИБ: форензика.

## Описание

Скрипт анализирует сетевые дампы в формате `.pcapng` или JSON-экспорта из Wireshark и выводит отчёт по ключевым артефактам: DHCP-обмену, DNS-запросам и подозрительным IP-адресам.

## Требования

```
pip install matplotlib pandas
```

Для работы с `.pcapng` напрямую дополнительно требуется **tshark** (устанавливается вместе с [Wireshark](https://www.wireshark.org/download.html)).

## Использование

```bash
# Из .pcapng файла (требует tshark)
python network_forensics.py --pcap dhcp.pcapng --out results

# Из JSON-экспорта Wireshark
python network_forensics.py --json dump.json --out results
```

Как экспортировать JSON из Wireshark: **File → Export Packet Dissections → As JSON**.

## Что анализирует скрипт

| Раздел | Содержание |
|--------|-----------|
| Общая статистика | Количество пакетов, объём, временной диапазон захвата |
| Протоколы | Топ протоколов по количеству пакетов |
| Топ IP-адресов | Наиболее активные источники и назначения |
| DHCP | Типы сообщений, MAC-адреса клиентов, выданные IP, серверы |
| DNS | Запросы и ответы, топ запрашиваемых доменов |
| Подозрительные IP | Нулевые адреса, broadcast, APIPA (169.254.x.x) |

## Результаты

После запуска в папке `--out` появятся:

- `*_analysis.png` — визуализация (6 графиков)
- `*_packets.csv` — все пакеты
- `*_dhcp.csv` — DHCP-события (если обнаружены)
- `*_dns.csv` — DNS-события (если обнаружены)

## Пример вывода (сокращенный)

```
============================================================
  ОТЧЕТ по дампу: <Наименование файла дампа>
============================================================

[1] ОБЩАЯ СТАТИСТИКА
  Всего пакетов : 4
  Общий объём   : 1312 байт (1.3 КБ)
  Начало захвата: 2004-12-05 19:16:24 UTC

[4] DHCP
  Всего DHCP-пакетов: 4
  Типы сообщений:
    DISCOVER     2
    OFFER        2
  MAC: 00:0b:82:01:fc:42  ->  IP: 192.168.0.10

[5] DNS
  DNS-трафик не обнаружен.

[6] ПОДОЗРИТЕЛЬНЫЕ IP-АДРЕСА
  [!] 0.0.0.0   — Нулевой адрес источника (клиент без IP)
  [!] 255.255.255.255 — Широковещательный адрес (broadcast)
```

## Структура проекта

```
dump-analysis/
├── network_forensics.py   # основной скрипт
├── dhcp.pcapng            # исходный дамп
├── dhcp_dhcp.csv          # вывод информации по пакетам DHCP в формате .csv
├── dhcp_packets.csv       # вывод общей информации по пакетам в формате .csv
├── dhcp_analysis.png      # График по результатам анализа 
└── README.md
```