# –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ BOTSv1 ‚Äî WinEventLog:Security + DNS

–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ –∫—É—Ä—Å—É Python ¬∑ –ù–ò–£ –í–®–≠

---

## –ó–∞–¥–∞–Ω–∏–µ

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–≤–∞ —Ç–∏–ø–∞ –ª–æ–≥–æ–≤ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ BOTSv1, –Ω–∞–π—Ç–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ
—Å–æ–±—ã—Ç–∏—è –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å 10 –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
log-analysis/
‚îú‚îÄ‚îÄ botsv1.json          # –î–∞—Ç–∞—Å–µ—Ç (35 WinEventLog + 3 DNS = 38 –∑–∞–ø–∏—Å–µ–π)
‚îú‚îÄ‚îÄ log_analysis.py      # –°–∫—Ä–∏–ø—Ç –∞–Ω–∞–ª–∏–∑–∞
‚îú‚îÄ‚îÄ botsv1_analysis.png  # –î–∞—à–±–æ—Ä–¥ (—Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ)
‚îî‚îÄ‚îÄ README.md
```

---

## –≠—Ç–∞–ø 1. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–°–∫—Ä–∏–ø—Ç —á–∏—Ç–∞–µ—Ç `botsv1.json` –∏ —Ä–∞–∑–¥–µ–ª—è–µ—Ç –∑–∞–ø–∏—Å–∏ –Ω–∞ –¥–≤–∞ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞:
**WinEventLog** (35 –∑–∞–ø–∏—Å–µ–π) –∏ **DNS** (3 –∑–∞–ø–∏—Å–∏).

–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:
- –ü–æ–ª—è-—Å–ø–∏—Å–∫–∏ (`Account_Name`, `Logon_ID`) ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç (—Ü–µ–ª–µ–≤–∞—è —É—á—ë—Ç–∫–∞)
- –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞ ‚Üí –∫–æ—Ä–æ—Ç–∫–æ–µ –∏–º—è (`C:\...\splunk-admon.exe` ‚Üí `splunk-admon.exe`)
- `New_Process_Name` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è EventCode 4688, `Process_Name` ‚Äî –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---|---|
| –ò—Å—Ç–æ—á–Ω–∏–∫ | [BOTS v1](https://github.com/splunk/botsv1) |
| –î–∞—Ç–∞ | 28 –∞–≤–≥—É—Å—Ç–∞ 2016 –≥. |
| –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π | 38 |
| –•–æ—Å—Ç–æ–≤ | 33 (`*.waynecorpinc.local`) |
| –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö EventCode | 5 |

---

## –≠—Ç–∞–ø 2. –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

### WinEventLog ‚Äî –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –ø–æ EventID

| EventCode | –û–ø–∏—Å–∞–Ω–∏–µ | –†–∏—Å–∫ | –ö–æ–ª-–≤–æ | –ü–æ—á–µ–º—É –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ |
|---|---|---|---|---|
| 4703 | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π —Ç–æ–∫–µ–Ω–∞ | üî¥ –í—ã—Å–æ–∫–∏–π | 12 | –ú–∞—Å—Å–æ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤ –Ω–∞ 11 —Ö–æ—Å—Ç–∞—Ö ‚Äî —ç—Å–∫–∞–ª–∞—Ü–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π |
| 4688 | –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ | üü° –°—Ä–µ–¥–Ω–∏–π | 9 | –°—Ä–µ–¥–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ ‚Äî `splunk-powershell.exe` (–Ω–µ—Ç–∏–ø–∏—á–Ω—ã–π) |
| 4624 | –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ (—Å–µ—Ç–µ–≤–æ–π) | üü° –°—Ä–µ–¥–Ω–∏–π | 3 | Kerberos + –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å IPv6 link-local ‚Äî lateral movement |
| 4656 | –ó–∞–ø—Ä–æ—Å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –æ–±—ä–µ–∫—Ç–∞ | üü° –°—Ä–µ–¥–Ω–∏–π | 1 | `Lara.Culbreth` –∑–∞–ø—Ä–æ—Å–∏–ª–∞ –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–Ω–æ–º—É –∫–∞—Ç–∞–ª–æ–≥—É |
| 4689 | –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ | üîµ –®—Ç–∞—Ç–Ω–æ–µ | 10 | –ù–µ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º |

–ò—Ç–æ–≥–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö: **25 –∏–∑ 35** —Å–æ–±—ã—Ç–∏–π WinEventLog.

### DNS ‚Äî –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ `eventtype` –∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –≤ –∏–º–µ–Ω–∏ –¥–æ–º–µ–Ω–∞:

| –î–æ–º–µ–Ω | IP-–∫–ª–∏–µ–Ω—Ç | –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ü—Ä–∏—á–∏–Ω–∞ |
|---|---|---|---|
| `ajd92jd9d.com` | 192.168.1.77 | –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π | –ü–æ–º–µ—á–µ–Ω –∫–∞–∫ suspicious –≤ eventtype |
| `c2.maliciousdomain.com` | 192.168.1.88 | –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π | –ü–æ–º–µ—á–µ–Ω –∫–∞–∫ suspicious, –∏–º—è —Å–æ–¥–µ—Ä–∂–∏—Ç `c2`/`malicious` |

---

## –≠—Ç–∞–ø 3. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

–î–∞—à–±–æ—Ä–¥ `botsv1_analysis.png` —Å–æ–¥–µ—Ä–∂–∏—Ç:

1. **–¢–æ–ø-10 –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π** ‚Äî –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–π –±–∞—Ä—á–∞—Ä—Ç WinEventLog + DNS,
   —Ü–≤–µ—Ç = —É—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞
2. **Donut-–¥–∏–∞–≥—Ä–∞–º–º–∞** ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Å–µ—Ö EventCode –≤ WinEventLog
3. **DNS-–∞–Ω–∞–ª–∏–∑** ‚Äî –±–∞—Ä—á–∞—Ä—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å –≤—ã–Ω–æ—Å–æ–º –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
4. **–ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Ö–æ–¥–∫–∏** ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∏ —Å —Ä–∞–∑–±–æ—Ä–æ–º —Ç—Ä—ë—Ö –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π

---

## –ó–∞–ø—É—Å–∫

```bash
pip install pandas matplotlib seaborn
python log_analysis.py
```

–°–∫—Ä–∏–ø—Ç –∏—â–µ—Ç `botsv1.json` —Ä—è–¥–æ–º —Å —Å–æ–±–æ–π. –î–∞—à–±–æ—Ä–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ `botsv1_analysis.png`.

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç

![–î–∞—à–±–æ—Ä–¥ –∞–Ω–∞–ª–∏–∑–∞ BOTSv1](botsv1_analysis.png)